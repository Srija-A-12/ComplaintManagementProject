<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SRMIST Complaint System - Register</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Inter', sans-serif; 
            background-color: #f8fafc; 
            background-image: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); 
        }
        .email-validation-message {
            transition: all 0.3s ease-in-out;
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-md p-8 space-y-6 bg-white rounded-2xl shadow-xl">
        <div class="text-center">
            <h1 class="text-3xl font-bold text-gray-800">Create an Account</h1>
            <p class="text-gray-500">Only SRMIST members can register.</p>
        </div>
        
        <form id="registrationForm" action="/register" method="POST" class="space-y-6">
            <div>
                <label for="email" class="text-sm font-medium text-gray-700">SRMIST Email Address</label>
                <input type="email" name="email" id="email" required
                       class="w-full px-4 py-2 mt-2 text-base text-gray-700 bg-gray-100 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                       placeholder="yourname@srmist.edu.in">
                Validation message area
                <p id="emailError" class="email-validation-message text-red-500 text-xs mt-1 h-4"></p>
            </div>

            <div>
                <label for="password" class="text-sm font-medium text-gray-700">Password</label>
                <input type="password" name="password" id="password" required
                       class="w-full px-4 py-2 mt-2 text-base text-gray-700 bg-gray-100 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                       placeholder="Choose a strong password">
            </div>

            <div>
                <label for="role" class="text-sm font-medium text-gray-700">I am a...</label>
                <select name="role" id="role" required
                        class="w-full px-4 py-2 mt-2 text-base text-gray-700 bg-gray-100 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    <option value="STUDENT">Student</option>
                    <option value="TEACHER">Teacher / HOD</option>
                </select>
            </div>

            <div>
                <button type="submit" id="registerButton"
                        class="w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-blue-500 to-teal-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition disabled:opacity-50 disabled:cursor-not-allowed transform hover:scale-105">
                    Register
                </button>
            </div>
        </form>

        <p class="text-sm text-center text-gray-600">
            Already have an account? 
            <a href="/login.html" class="font-medium text-indigo-600 hover:text-indigo-500">Sign in</a>
        </p>
    </div>

    <script>
        const emailInput = document.getElementById('email');
        const emailError = document.getElementById('emailError');
        const registerButton = document.getElementById('registerButton');
        const registrationForm = document.getElementById('registrationForm');
        const requiredDomain = '@srmist.edu.in';

        function validateEmail() {
            const email = emailInput.value.toLowerCase();
            if (email === '' || email.endsWith(requiredDomain)) {
                emailError.textContent = '';
                registerButton.disabled = false;
            } else {
                emailError.textContent = `Email must end with ${requiredDomain}`;
                registerButton.disabled = true;
            }
        }

        emailInput.addEventListener('input', validateEmail);

        registrationForm.addEventListener('submit', function(event) {
            if (registerButton.disabled) {
                event.preventDefault();
            }
        });
        
        validateEmail();
    </script>
</body>
</html>

 -->
<!--  
 
 <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SRMIST Complaint System - Register</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Inter', sans-serif; 
            background-color: #f8fafc; 
            background-image: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); 
        }
        /* Style for the validation message */
        .validation-message {
            transition: all 0.3s ease-in-out;
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-md p-8 space-y-6 bg-white rounded-2xl shadow-xl">
        <div class="text-center">
            <img src="https://placehold.co/100x100/003366/FFFFFF?text=SRM" alt="SRMIST Logo" class="mx-auto mb-4 rounded-full">
            <h1 class="text-3xl font-bold text-gray-800">Create Your Account</h1>
            <p class="text-gray-500">Only <span class="font-semibold text-indigo-600">@srmist.edu.in</span> emails are allowed.</p>
        </div>
        
        The form action points to your Spring Boot /register endpoint
        <form action="/register" method="POST" class="space-y-6">
            <div>
                <label for="email" class="text-sm font-medium text-gray-700">SRMIST Email</label>
                <input type="email" name="email" id="email" required
                       class="w-full px-4 py-2 mt-2 text-base text-gray-700 bg-gray-100 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                       placeholder="your_name123@srmist.edu.in">
                Error message for email validation
                <p id="emailError" class="validation-message text-red-500 text-xs mt-1 h-4 opacity-0">
                    Please enter a valid @srmist.edu.in email.
                </p>
            </div>

            <div>
                <label for="password" class="text-sm font-medium text-gray-700">Password</label>
                <input type="password" name="password" id="password" required
                       class="w-full px-4 py-2 mt-2 text-base text-gray-700 bg-gray-100 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                       placeholder="Choose a strong password">
            </div>

            <div>
                <label for="role" class="text-sm font-medium text-gray-700">I am a...</label>
                <select name="role" id="role" required
                        class="w-full px-4 py-2 mt-2 text-base text-gray-700 bg-gray-100 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    <option value="STUDENT">Student</option>
                    <option value="TEACHER">Teacher / HOD</option>
                </select>
            </div>

            <div>
                <button type="submit" id="registerButton"
                        class="w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-blue-500 to-teal-500 hover:from-blue-600 hover:to-teal-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-transform transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed">
                    Register
                </button>
            </div>
        </form>

        <p class="text-sm text-center text-gray-600">
            Already have an account? 
            <a href="/login.html" class="font-medium text-indigo-600 hover:text-indigo-500">Sign in here</a>
        </p>
    </div>

    <script>
        const emailInput = document.getElementById('email');
        const emailError = document.getElementById('emailError');
        const registerButton = document.getElementById('registerButton');

        // THIS IS THE CORRECTED VALIDATION RULE
        // It allows letters (a-z), numbers (0-9), underscores (_), and dots (.).
        const emailRegex = /^[a-zA-Z0-9_.]+@srmist\.edu\.in$/;

        function validateEmail() {
            const email = emailInput.value.toLowerCase();
            if (email === "" || emailRegex.test(email)) {
                emailError.classList.add('opacity-0');
                registerButton.disabled = false;
            } else {
                emailError.classList.remove('opacity-0');
                registerButton.disabled = true;
            }
        }

        // Check the email whenever the user types
        emailInput.addEventListener('input', validateEmail);

        // Initial check in case the browser autofills the form
        document.addEventListener('DOMContentLoaded', validateEmail);
    </script>

</body>
</html>
 -->
 
 <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SRMIST Complaint System - Register</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Inter', sans-serif; 
            background-color: #f8fafc; 
            background-image: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); 
        }
        .validation-message, .modal-backdrop, .modal-content {
            transition: all 0.3s ease-in-out;
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-md p-8 space-y-6 bg-white rounded-2xl shadow-xl">
        <div class="text-center">
            <img src="https://placehold.co/100x100/003366/FFFFFF?text=SRM" alt="SRMIST Logo" class="mx-auto mb-4 rounded-full">
            <h1 class="text-3xl font-bold text-gray-800">Create Your Account</h1>
            <p class="text-gray-500">Only <span class="font-semibold text-indigo-600">@srmist.edu.in</span> emails are allowed.</p>
        </div>
        
        <form id="registrationForm" class="space-y-6">
            <div>
                <label for="email" class="text-sm font-medium text-gray-700">SRMIST Email</label>
                <input type="email" name="email" id="email" required
                       class="w-full px-4 py-2 mt-2 text-base text-gray-700 bg-gray-100 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                       placeholder="your_name123@srmist.edu.in">
                <p id="emailError" class="validation-message text-red-500 text-xs mt-1 h-4 opacity-0">
                    Please enter a valid @srmist.edu.in email.
                </p>
            </div>

            <div>
                <label for="password" class="text-sm font-medium text-gray-700">Password</label>
                <input type="password" name="password" id="password" required
                       class="w-full px-4 py-2 mt-2 text-base text-gray-700 bg-gray-100 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                       placeholder="Choose a strong password">
            </div>

            <div>
                <label for="role" class="text-sm font-medium text-gray-700">I am a...</label>
                <select name="role" id="role" required
                        class="w-full px-4 py-2 mt-2 text-base text-gray-700 bg-gray-100 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    <option value="STUDENT">Student</option>
                    <option value="TEACHER">Teacher / HOD</option>
                </select>
            </div>

            <div>
                <button type="submit" id="registerButton"
                        class="w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-blue-500 to-teal-500 hover:from-blue-600 hover:to-teal-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-transform transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed">
                    Register
                </button>
            </div>
        </form>

        <p class="text-sm text-center text-gray-600">
            Already have an account? 
            <a href="/login.html" class="font-medium text-indigo-600 hover:text-indigo-500">Sign in here</a>
        </p>
    </div>
    
    <!-- Success/Error Modal -->
    <div id="popupModal" class="fixed inset-0 z-50 flex items-center justify-center p-4 modal-backdrop bg-black bg-opacity-50 hidden opacity-0">
        <div class="modal-content bg-white w-full max-w-sm p-6 rounded-2xl shadow-2xl text-center transform scale-95 opacity-0">
            <div id="modalIconContainer" class="mx-auto mb-4 w-16 h-16 rounded-full flex items-center justify-center">
                <!-- Icon will be inserted here by JS -->
            </div>
            <h2 id="modalTitle" class="text-2xl font-bold mb-2 text-gray-800"></h2>
            <p id="modalMessage" class="text-gray-600 mb-6"></p>
            <button id="modalButton" class="px-6 py-2 rounded-lg font-semibold shadow-md transition transform hover:scale-105">
                <!-- Button text and action will be set by JS -->
            </button>
        </div>
    </div>


    <script>
        // --- Form Validation Script ---
        const emailInput = document.getElementById('email');
        const emailError = document.getElementById('emailError');
        const registerButton = document.getElementById('registerButton');
        const emailRegex = /^[a-zA-Z0-9_.]+@srmist\.edu\.in$/;

        function validateEmail() {
            const email = emailInput.value.toLowerCase();
            if (email === "" || emailRegex.test(email)) {
                emailError.classList.add('opacity-0');
                registerButton.disabled = false;
            } else {
                emailError.classList.remove('opacity-0');
                registerButton.disabled = true;
            }
        }
        emailInput.addEventListener('input', validateEmail);
        document.addEventListener('DOMContentLoaded', validateEmail);
        
        // --- Form Submission & Modal Script ---
        const registrationForm = document.getElementById('registrationForm');
        const popupModal = document.getElementById('popupModal');
        const modalContent = popupModal.querySelector('.modal-content');
        
        const modalIconContainer = document.getElementById('modalIconContainer');
        const modalTitle = document.getElementById('modalTitle');
        const modalMessage = document.getElementById('modalMessage');
        const modalButton = document.getElementById('modalButton');

        function openModal({ isSuccess, title, message, buttonText, buttonAction }) {
            // Set content based on success or error
            modalTitle.textContent = title;
            modalMessage.textContent = message;
            modalButton.textContent = buttonText;
            
            if (isSuccess) {
                modalIconContainer.innerHTML = `<svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>`;
                modalIconContainer.className = 'mx-auto mb-4 w-16 h-16 rounded-full flex items-center justify-center bg-green-500';
                modalButton.className = 'bg-green-500 text-white px-6 py-2 rounded-lg font-semibold shadow-md transition transform hover:scale-105';
            } else {
                modalIconContainer.innerHTML = `<svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>`;
                modalIconContainer.className = 'mx-auto mb-4 w-16 h-16 rounded-full flex items-center justify-center bg-red-500';
                modalButton.className = 'bg-red-500 text-white px-6 py-2 rounded-lg font-semibold shadow-md transition transform hover:scale-105';
            }

            modalButton.onclick = buttonAction;

            // Show modal with animation
            popupModal.classList.remove('hidden');
            setTimeout(() => {
                popupModal.classList.remove('opacity-0');
                modalContent.classList.remove('scale-95', 'opacity-0');
            }, 10);
        }

        function closeModal() {
            popupModal.classList.add('opacity-0');
            modalContent.classList.add('scale-95', 'opacity-0');
            setTimeout(() => popupModal.classList.add('hidden'), 300);
        }

        registrationForm.addEventListener('submit', function(event) {
            event.preventDefault(); // Stop the default form submission

            registerButton.textContent = "Registering...";
            registerButton.disabled = true;

            const formData = new FormData(registrationForm);

            fetch('/register', {
                method: 'POST',
                body: new URLSearchParams(formData) // Send as form-encoded data
            })
            .then(response => {
                if (response.ok) {
                    return response.text(); // Success case, can still have a message
                } else {
                    // Failure case, get error message from backend
                    return response.text().then(text => { throw new Error(text) });
                }
            })
            .then(successMessage => {
                registrationForm.reset();
                openModal({
                    isSuccess: true,
                    title: 'Success!',
                    message: 'Your account has been created.',
                    buttonText: 'Go to Login',
                    buttonAction: () => { window.location.href = '/login.html'; }
                });
            })
            .catch(error => {
                openModal({
                    isSuccess: false,
                    title: 'Registration Failed',
                    message: error.message || 'An unknown error occurred.',
                    buttonText: 'Try Again',
                    buttonAction: closeModal
                });
            })
            .finally(() => {
                registerButton.textContent = "Register";
                registerButton.disabled = false;
                validateEmail(); // Re-check validation
            });
        });
        
    </script>

</body>
</html>

 